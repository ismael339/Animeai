<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AnimeIA - Encuentra tu anime perfecto con inteligencia artificial</title>
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="Descubre anime personalizado con IA. Describe lo que buscas y nuestra inteligencia artificial te recomendar√° el anime perfecto para ti. ¬°Encuentra tu pr√≥xima serie favorita!">
    <meta name="keywords" content="anime, buscador anime, IA anime, recomendaciones anime, inteligencia artificial, otaku, manga, series japonesas">
    <meta name="author" content="AnimeIA">
    <meta name="robots" content="index, follow">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://animeia.com/">
    <meta property="og:title" content="AnimeIA - Encuentra tu anime perfecto con IA">
    <meta property="og:description" content="Descubre anime personalizado con IA. Describe lo que buscas y nuestra inteligencia artificial te recomendar√° el anime perfecto.">
    <meta property="og:image" content="https://animeia.com/og-image.jpg">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://animeia.com/">
    <meta property="twitter:title" content="AnimeIA - Encuentra tu anime perfecto con IA">
    <meta property="twitter:description" content="Descubre anime personalizado con IA. Describe lo que buscas y nuestra inteligencia artificial te recomendar√° el anime perfecto.">
    <meta property="twitter:image" content="https://animeia.com/twitter-image.jpg">
    
    <!-- Favicons -->
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    
    <!-- Schema.org JSON-LD -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "AnimeIA",
        "description": "Buscador de anime con inteligencia artificial que recomienda series bas√°ndose en descripciones de usuarios",
        "url": "https://animeia.com",
        "applicationCategory": "Entertainment",
        "operatingSystem": "Any",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "USD"
        }
    }
    </script>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        :root {
            --primary: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --secondary: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --accent: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            --dark: #1a1a2e;
            --dark-light: #16213e;
            --text-primary: #ffffff;
            --text-secondary: #b8c6db;
            --text-dark: #2d3748;
            --glass: rgba(255, 255, 255, 0.1);
            --glass-border: rgba(255, 255, 255, 0.2);
            --shadow: 0 8px 32px rgba(31, 38, 135, 0.37);
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background: var(--dark);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
        }
        
        .bg-animation {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            background: linear-gradient(45deg, #1a1a2e, #16213e, #0f0f23);
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
        }
        
        .bg-animation::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: 
                radial-gradient(circle at 25% 25%, rgba(102, 126, 234, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 75% 75%, rgba(245, 87, 108, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 75% 25%, rgba(79, 172, 254, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 25% 75%, rgba(118, 75, 162, 0.1) 0%, transparent 50%);
            animation: float 20s ease-in-out infinite;
        }
        
        @keyframes gradientShift {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            33% { transform: translateY(-20px) rotate(1deg); }
            66% { transform: translateY(-10px) rotate(-1deg); }
        }
        
        .header {
            position: fixed;
            top: 0;
            width: 100%;
            padding: 1rem 2rem;
            background: rgba(26, 26, 46, 0.9);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--glass-border);
            z-index: 1000;
            transition: all 0.3s ease;
        }
        
        .nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .logo {
            font-family: 'Poppins', sans-serif;
            font-size: 1.8rem;
            font-weight: 700;
            background: var(--primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .nav-links {
            display: flex;
            gap: 2rem;
            list-style: none;
        }
        
        .nav-links a {
            color: var(--text-secondary);
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .nav-links a:hover {
            color: var(--text-primary);
            transform: translateY(-2px);
        }
        
        .nav-links a::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 0;
            width: 0;
            height: 2px;
            background: var(--accent);
            transition: width 0.3s ease;
        }
        
        .nav-links a:hover::after {
            width: 100%;
        }
        
        .main {
            padding-top: 100px;
            min-height: 100vh;
        }
        
        .hero {
            text-align: center;
            padding: 4rem 2rem;
            max-width: 1000px;
            margin: 0 auto;
        }
        
        .hero h1 {
            font-family: 'Poppins', sans-serif;
            font-size: clamp(2.5rem, 5vw, 4rem);
            font-weight: 700;
            margin-bottom: 1rem;
            background: var(--primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            line-height: 1.2;
        }
        
        .hero p {
            font-size: 1.2rem;
            color: var(--text-secondary);
            margin-bottom: 3rem;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }
        
        .search-section {
            max-width: 800px;
            margin: 0 auto 4rem;
            padding: 0 2rem;
        }
        
        .search-container {
            background: var(--glass);
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: 2rem;
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
        }
        
        .search-container:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 40px rgba(31, 38, 135, 0.5);
        }
        
        .search-form {
            position: relative;
        }
        
        .search-input {
            width: 100%;
            padding: 1.5rem 1.5rem 1.5rem 4rem;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid var(--glass-border);
            border-radius: 15px;
            color: var(--text-primary);
            font-size: 1.1rem;
            font-family: inherit;
            resize: vertical;
            min-height: 120px;
            transition: all 0.3s ease;
        }
        
        .search-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.3);
            background: rgba(255, 255, 255, 0.15);
        }
        
        .search-input::placeholder {
            color: var(--text-secondary);
            opacity: 0.7;
        }
        
        .search-icon {
            position: absolute;
            left: 1.5rem;
            top: 1.5rem;
            width: 24px;
            height: 24px;
            color: var(--text-secondary);
        }
        
        .search-btn {
            width: 100%;
            margin-top: 1.5rem;
            padding: 1rem 2rem;
            background: var(--primary);
            border: none;
            border-radius: 12px;
            color: white;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .search-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4);
        }
        
        .search-btn:active {
            transform: translateY(0);
        }
        
        .search-btn.loading .btn-text {
            opacity: 0;
        }
        
        .search-btn.loading::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 20px;
            height: 20px;
            margin: -10px 0 0 -10px;
            border: 2px solid transparent;
            border-top: 2px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .examples {
            margin-top: 2rem;
            text-align: center;
        }
        
        .examples h3 {
            color: var(--text-secondary);
            margin-bottom: 1rem;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .example-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            justify-content: center;
        }
        
        .example-tag {
            padding: 0.5rem 1rem;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid var(--glass-border);
            border-radius: 25px;
            color: var(--text-secondary);
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .example-tag:hover {
            background: rgba(102, 126, 234, 0.2);
            color: var(--text-primary);
            transform: translateY(-2px);
        }
        
        .results {
            max-width: 1000px;
            margin: 4rem auto 0;
            padding: 0 2rem;
            opacity: 0;
            transform: translateY(30px);
            transition: all 0.5s ease;
            display: none;
        }
        
        .results.show {
            opacity: 1;
            transform: translateY(0);
            display: block;
        }
        
        .results h2 {
            text-align: center;
            margin-bottom: 2rem;
            font-family: 'Poppins', sans-serif;
            background: var(--secondary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .match-info {
            text-align: center;
            color: var(--text-secondary);
            margin-bottom: 2rem;
            font-size: 1.1rem;
        }
        
        .anime-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-bottom: 4rem;
        }
        
        .anime-card {
            background: var(--glass);
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: 1.5rem;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            animation: fadeInUp 0.5s ease forwards;
            opacity: 0;
        }
        
        .anime-card:nth-child(1) { animation-delay: 0.1s; }
        .anime-card:nth-child(2) { animation-delay: 0.2s; }
        .anime-card:nth-child(3) { animation-delay: 0.3s; }
        .anime-card:nth-child(4) { animation-delay: 0.4s; }
        .anime-card:nth-child(5) { animation-delay: 0.5s; }
        
        @keyframes fadeInUp {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .anime-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--accent);
            transform: translateX(-100%);
            transition: transform 0.3s ease;
        }
        
        .anime-card:hover::before {
            transform: translateX(0);
        }
        
        .anime-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 40px rgba(31, 38, 135, 0.4);
        }
        
        .match-score {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: rgba(102, 126, 234, 0.9);
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            color: white;
        }
        
        .anime-title {
            font-family: 'Poppins', sans-serif;
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--text-primary);
        }
        
        .anime-genres {
            display: flex;
            flex-wrap: wrap;
            gap: 0.3rem;
            margin-bottom: 1rem;
        }
        
        .genre-tag {
            padding: 0.2rem 0.6rem;
            background: rgba(102, 126, 234, 0.2);
            border: 1px solid rgba(102, 126, 234, 0.3);
            border-radius: 12px;
            font-size: 0.8rem;
            color: var(--text-secondary);
        }
        
        .anime-description {
            color: var(--text-secondary);
            line-height: 1.6;
            margin-bottom: 1rem;
        }
        
        .anime-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.9rem;
            color: var(--text-secondary);
            flex-wrap: wrap;
            gap: 0.5rem;
        }
        
        .rating {
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }
        
        .rating-star {
            color: #fbbf24;
        }
        
        .features {
            padding: 6rem 2rem;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .features h2 {
            text-align: center;
            font-family: 'Poppins', sans-serif;
            font-size: 2.5rem;
            margin-bottom: 3rem;
            background: var(--accent);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
        }
        
        .feature-card {
            background: var(--glass);
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: 2rem;
            text-align: center;
            transition: all 0.3s ease;
        }
        
        .feature-card:hover {
            transform: translateY(-10px);
            box-shadow: var(--shadow);
        }
        
        .feature-icon {
            width: 60px;
            height: 60px;
            margin: 0 auto 1rem;
            background: var(--primary);
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }
        
        .feature-card h3 {
            font-family: 'Poppins', sans-serif;
            margin-bottom: 1rem;
            color: var(--text-primary);
        }
        
        .feature-card p {
            color: var(--text-secondary);
            line-height: 1.6;
        }
        
        .footer {
            background: var(--dark-light);
            padding: 3rem 2rem 1rem;
            text-align: center;
            border-top: 1px solid var(--glass-border);
        }
        
        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .footer p {
            color: var(--text-secondary);
            margin-bottom: 1rem;
        }
        
        .footer-links {
            display: flex;
            justify-content: center;
            gap: 2rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }
        
        .footer-links a {
            color: var(--text-secondary);
            text-decoration: none;
            transition: color 0.3s ease;
        }
        
        .footer-links a:hover {
            color: var(--text-primary);
        }
        
        @media (max-width: 768px) {
            .nav-links {
                display: none;
            }
            
            .hero {
                padding: 2rem 1rem;
            }
            
            .search-section {
                padding: 0 1rem;
            }
            
            .search-container {
                padding: 1.5rem;
            }
            
            .search-input {
                padding: 1rem 1rem 1rem 3rem;
                font-size: 1rem;
            }
            
            .search-icon {
                left: 1rem;
                top: 1rem;
            }
            
            .anime-grid {
                grid-template-columns: 1fr;
            }
            
            .features {
                padding: 4rem 1rem;
            }
            
            .features h2 {
                font-size: 2rem;
            }
            
            .footer-links {
                flex-direction: column;
                gap: 1rem;
            }
        }
        
        @media (prefers-reduced-motion: reduce) {
            * {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }
    </style>
</head>
<body>
    <div class="bg-animation"></div>
    
    <header class="header">
        <nav class="nav">
            <div class="logo">AnimeIA</div>
            <ul class="nav-links">
                <li><a href="#inicio">Inicio</a></li>
                <li><a href="#buscar">Buscar</a></li>
                <li><a href="#como-funciona">C√≥mo Funciona</a></li>
                <li><a href="#contacto">Contacto</a></li>
            </ul>
        </nav>
    </header>
    
    <main class="main">
        <section class="hero" id="inicio">
            <h1>Encuentra tu anime perfecto con IA</h1>
            <p>Describe lo que buscas y nuestra inteligencia artificial te recomendar√° el anime ideal para ti. ¬°Descubre tu pr√≥xima serie favorita en segundos!</p>
        </section>
        
        <section class="search-section" id="buscar">
            <div class="search-container">
                <form class="search-form" id="searchForm">
                    <svg class="search-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                    </svg>
                    <textarea 
                        id="searchInput"
                        class="search-input" 
                        placeholder="Describe el anime que buscas... Por ejemplo: 'Quiero un anime de acci√≥n con protagonista fuerte, batallas √©picas y algo de romance. Que no sea muy largo y tenga buena animaci√≥n.'"
                        required
                        maxlength="500"
                    ></textarea>
                    <button type="submit" class="search-btn" id="searchBtn">
                        <span class="btn-text">Buscar con IA</span>
                    </button>
                </form>
                
                <div class="examples">
                    <h3>Ejemplos populares</h3>
                    <div class="example-tags">
                        <span class="example-tag" onclick="fillExample('Anime de fantas√≠a con magia y aventuras √©picas')">Fantas√≠a m√°gica</span>
                        <span class="example-tag" onclick="fillExample('Romance escolar con comedia y personajes carism√°ticos')">Romance escolar</span>
                        <span class="example-tag" onclick="fillExample('Acci√≥n con poderes sobrenaturales y peleas intensas')">Poderes sobrenaturales</span>
                        <span class="example-tag" onclick="fillExample('Thriller psicol√≥gico oscuro con giros inesperados')">Thriller psicol√≥gico</span>
                        <span class="example-tag" onclick="fillExample('Deportes con superaci√≥n personal y trabajo en equipo')">Deportes</span>
                    </div>
                </div>
            </div>
        </section>
        
        <section class="results" id="results">
            <h2>Recomendaciones para ti</h2>
            <p class="match-info" id="matchInfo"></p>
            <div class="anime-grid" id="animeGrid"></div>
        </section>
        
        <section class="features" id="como-funciona">
            <h2>¬øC√≥mo funciona?</h2>
            <div class="features-grid">
                <div class="feature-card">
                    <div class="feature-icon">ü§ñ</div>
                    <h3>IA Avanzada</h3>
                    <p>Nuestra inteligencia artificial analiza tu descripci√≥n y encuentra patrones en miles de anime para darte las mejores recomendaciones.</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">üéØ</div>
                    <h3>Precisi√≥n Alta</h3>
                    <p>Algoritmos especializados que entienden g√©neros, tramas, estilos de animaci√≥n y preferencias personales para resultados exactos.</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">‚ö°</div>
                    <h3>Resultados Instant√°neos</h3>
                    <p>Obt√©n recomendaciones personalizadas en segundos. No m√°s horas navegando listas interminables de anime.</p>
                </div>
            </div>
        </section>
    </main>
    
    <footer class="footer" id="contacto">
        <div class="footer-content">
            <p>¬© 2024 AnimeIA. Encuentra tu anime perfecto con inteligencia artificial.</p>
            <div class="footer-links">
                <a href="#privacidad">Pol√≠tica de Privacidad</a>
                <a href="#terminos">T√©rminos de Uso</a>
                <a href="#api">API</a>
                <a href="#contacto">Contacto</a>
                <a href="#blog">Blog</a>
            </div>
            <p>Hecho con ‚ù§Ô∏è para la comunidad otaku</p>
        </div>
    </footer>
    
<script>
// Sistema de sin√≥nimos expandido
const synonyms = {
  "amor": ["romance", "amor", "pareja", "enamorado", "rom√°ntico", "love"],
  "romance": ["romance", "amor", "pareja", "enamorado", "rom√°ntico"],
  "harem": ["harem", "reverse harem"],
  "pelea": ["action", "pelea", "peleas", "batalla", "combate", "lucha"],
  "acci√≥n": ["action", "pelea", "batalla", "combate", "lucha"],
  "comedia": ["comedy", "comedia", "divertido", "gracioso", "humor"],
  "divertido": ["comedy", "comedia", "divertido", "gracioso"],
  "triste": ["drama", "triste", "emocional", "l√°grimas"],
  "drama": ["drama", "triste", "emocional", "l√°grimas"],
  "miedo": ["horror", "miedo", "terror", "oscuro", "gore"],
  "terror": ["horror", "miedo", "terror", "oscuro"],
  "magia": ["magic", "magia", "fantas√≠a", "m√°gico", "fantasy"],
  "fantas√≠a": ["fantasy", "magia", "fantas√≠a", "m√°gico"],
  "isekai": ["isekai", "otro mundo", "reencarnaci√≥n", "transportado"],
  "otro mundo": ["isekai", "otro mundo", "reencarnaci√≥n"],
  "escuela": ["school", "escuela", "escolar", "estudiante"],
  "estudiante": ["school", "escuela", "escolar", "estudiante"],
  "poderes": ["super power", "poderes", "superpoderes", "habilidades"],
  "superpoderes": ["super power", "poderes", "habilidades"],
  "ninja": ["martial arts", "ninja", "shinobi"],
  "samurai": ["samurai", "espadas", "katana", "sword"],
  "robot": ["mecha", "robot", "robots"],
  "mecha": ["mecha", "robot", "robots"],
  "espacio": ["space", "espacio", "espacial", "sci-fi"],
  "futuro": ["sci-fi", "futuro", "ciencia ficci√≥n"],
  "tiempo": ["time travel", "viaje en el tiempo", "tiempo"],
  "vampiro": ["vampire", "vampiro", "vampiros"],
  "demonio": ["demon", "demonio", "demonios", "devil"],
  "militar": ["military", "militar", "guerra", "army"],
  "m√∫sica": ["music", "m√∫sica", "banda", "musical"],
  "deportes": ["sports", "deportes", "deporte"],
  "psicol√≥gico": ["psychological", "psicol√≥gico", "mente"],
  "misterio": ["mystery", "misterio", "detective"],
  "zombies": ["zombie", "zombies", "undead"],
  "gore": ["gore", "violencia", "sangre", "violent"]
};

const searchForm = document.getElementById("searchForm");
const searchInput = document.getElementById("searchInput");
const searchBtn = document.getElementById("searchBtn");
const animeGrid = document.getElementById("animeGrid");
const matchInfo = document.getElementById("matchInfo");
const resultsSection = document.getElementById("results");

function fillExample(text) {
  searchInput.value = text;
  searchInput.focus();
}

// Funci√≥n para buscar anime usando la API de Jikan
async function searchAnimeAPI(query) {
  query = query.toLowerCase().trim();
  if (!query) return [];

  const queryWords = query.split(" ").filter(w => w.length > 2);
  
  // Expandir con sin√≥nimos
  const expandedWords = new Set();
  queryWords.forEach(word => {
    expandedWords.add(word);
    if (synonyms[word]) {
      synonyms[word].forEach(syn => expandedWords.add(syn));
    }
  });

  try {
    // Buscar en la API de Jikan
    const searchQuery = Array.from(expandedWords).join(" ");
    const response = await fetch(`https://api.jikan.moe/v4/anime?q=${encodeURIComponent(searchQuery)}&limit=20&order_by=score&sort=desc`);
    
    if (!response.ok) {
      throw new Error('Error en la API');
    }

    const data = await response.json();
    
    // Procesar resultados
    const results = data.data.map(anime => {
      // Calcular score de coincidencia
      const animeText = `
        ${anime.title} 
        ${anime.title_english || ''} 
        ${anime.title_japanese || ''} 
        ${anime.synopsis || ''} 
        ${anime.genres?.map(g => g.name).join(' ') || ''}
        ${anime.themes?.map(t => t.name).join(' ') || ''}
        ${anime.demographics?.map(d => d.name).join(' ') || ''}
      `.toLowerCase();

      let matchScore = 0;
      expandedWords.forEach(word => {
        if (animeText.includes(word.toLowerCase())) {
          matchScore++;
        }
      });

      return {
        title: anime.title_english || anime.title,
        titleJapanese: anime.title_japanese,
        genres: anime.genres?.map(g => g.name) || [],
        description: anime.synopsis ? 
          (anime.synopsis.length > 200 ? anime.synopsis.substring(0, 200) + '...' : anime.synopsis) : 
          'Sin descripci√≥n disponible',
        rating: anime.score || 0,
        year: anime.year || anime.aired?.from ? new Date(anime.aired.from).getFullYear() : 'N/A',
        episodes: anime.episodes || '?',
        image: anime.images?.jpg?.large_image_url || anime.images?.jpg?.image_url,
        type: anime.type, // TV, Movie, OVA, etc
        status: anime.status, // Airing, Finished, etc
        studios: anime.studios?.map(s => s.name).join(', ') || 'Desconocido',
        source: anime.source || 'Desconocido', // Manga, Light novel, etc
        duration: anime.duration || 'N/A',
        popularity: anime.popularity,
        members: anime.members,
        url: anime.url,
        matchScore: matchScore
      };
    });

    // Filtrar y ordenar
    return results
      .filter(anime => anime.matchScore > 0)
      .sort((a, b) => b.matchScore - a.matchScore || b.rating - a.rating)
      .slice(0, 10);

  } catch (error) {
    console.error('Error al buscar anime:', error);
    return [];
  }
}

function displayResults(results) {
  animeGrid.innerHTML = "";
  
  if (results.length === 0) {
    matchInfo.textContent = "No se encontraron animes. Intenta con otros t√©rminos: acci√≥n, romance, isekai, etc.";
    resultsSection.classList.add("show");
    return;
  }

  matchInfo.textContent = `Se encontraron ${results.length} animes en MyAnimeList:`;

  results.forEach(anime => {
    const card = document.createElement("div");
    card.classList.add("anime-card");
    
    const genresHTML = anime.genres.slice(0, 5).map(g => `<span class="genre-tag">${g}</span>`).join("");
    
    card.innerHTML = `
      ${anime.image ? `<img src="${anime.image}" alt="${anime.title}" style="width: 100%; height: 200px; object-fit: cover; border-radius: 10px; margin-bottom: 1rem;">` : ''}
      <div class="match-score">Match: ${anime.matchScore}</div>
      <h3 class="anime-title">${anime.title}</h3>
      ${anime.titleJapanese ? `<p style="color: var(--text-secondary); font-size: 0.9rem; margin-bottom: 0.5rem;">${anime.titleJapanese}</p>` : ''}
      <div class="anime-genres">${genresHTML}</div>
      <p class="anime-description">${anime.description}</p>
      <div class="anime-meta">
        <span><strong>Tipo:</strong> ${anime.type}</span>
        <span><strong>A√±o:</strong> ${anime.year}</span>
        <span><strong>Episodios:</strong> ${anime.episodes}</span>
        <span><strong>Rating:</strong> ${anime.rating ? anime.rating.toFixed(1) : 'N/A'} ‚≠ê</span>
      </div>
      <div style="margin-top: 1rem; padding-top: 1rem; border-top: 1px solid var(--glass-border);">
        <p style="font-size: 0.85rem; color: var(--text-secondary); margin-bottom: 0.5rem;">
          <strong>Studio:</strong> ${anime.studios}
        </p>
        <p style="font-size: 0.85rem; color: var(--text-secondary); margin-bottom: 0.5rem;">
          <strong>Fuente:</strong> ${anime.source}
        </p>
        <p style="font-size: 0.85rem; color: var(--text-secondary); margin-bottom: 0.5rem;">
          <strong>Duraci√≥n:</strong> ${anime.duration}
        </p>
        <p style="font-size: 0.85rem; color: var(--text-secondary); margin-bottom: 0.5rem;">
          <strong>Popularidad:</strong> #${anime.popularity}
        </p>
        <a href="${anime.url}" target="_blank" style="display: inline-block; margin-top: 0.5rem; padding: 0.5rem 1rem; background: var(--accent); color: white; text-decoration: none; border-radius: 8px; font-size: 0.9rem;">
          Ver en MyAnimeList
        </a>
      </div>
    `;
    animeGrid.appendChild(card);
  });

  resultsSection.classList.add("show");
  resultsSection.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
}

searchForm.addEventListener("submit", async (e) => {
  e.preventDefault();
  searchBtn.classList.add("loading");

  try {
    const query = searchInput.value;
    const results = await searchAnimeAPI(query);
    displayResults(results);
  } catch (error) {
    console.error('Error:', error);
    matchInfo.textContent = "Error al buscar. Intenta de nuevo.";
    resultsSection.classList.add("show");
  } finally {
    searchBtn.classList.remove("loading");
  }
});
</script>