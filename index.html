<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-6HSE98W5M7"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-6HSE98W5M7');
    </script>
    
    <!-- Ad Script - Cargado de forma as√≠ncrona y eficiente -->
    <script type="text/javascript">
      (function() {
        var script = document.createElement('script');
        script.type = 'text/javascript';
        script.async = true;
        script.src = '//pl28211130.effectivegatecpm.com/22/f7/26/22f72613dc262b6b2730128a2bde63a8.js';
        script.onerror = function() {
          console.log('Ad script loading issue - continuing without ads');
        };
        var firstScript = document.getElementsByTagName('script')[0];
        firstScript.parentNode.insertBefore(script, firstScript);
      })();
    </script>
    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- SEO ULTRA OPTIMIZADO PARA GOOGLE -->
    <title>AnimeAI - AI Anime Search Engine | Find & Watch 40,000+ Free Animes Online</title>
    <meta name="description" content="Find your perfect anime with AI! Search 40,000+ animes by describing what you want in any language. Watch free online with HD streaming. Best anime finder 2024.">
    <meta name="keywords" content="anime AI search, find anime, watch anime free, anime recommendations, anime online, free anime streaming, best anime finder, AI anime, ver anime gratis, anime search engine, MyAnimeList, anilist, crunchyroll alternative">
    <meta name="author" content="AnimeAI">
    <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">
    <meta name="language" content="English">
    <meta name="revisit-after" content="1 days">
    <meta name="distribution" content="global">
    <meta name="rating" content="general">
    
    <!-- Geo Targeting -->
    <meta name="geo.region" content="US, ES, IN, SA, CA, TH, GB, AU, MX, BR">
    <meta name="geo.placename" content="Worldwide">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://animeai-psi.vercel.app/">
    <meta property="og:title" content="AnimeAI - Find Your Perfect Anime with AI | 40,000+ Animes">
    <meta property="og:description" content="AI-powered anime search. Describe what you want in any language and watch free online instantly!">
    <meta property="og:image" content="https://animeai-psi.vercel.app/og-image.jpg">
    <meta property="og:site_name" content="AnimeAI">
    <meta property="og:locale" content="en_US">
    <meta property="og:locale:alternate" content="es_ES">
    <meta property="og:locale:alternate" content="ja_JP">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@AnimeAI">
    <meta name="twitter:creator" content="@AnimeAI">
    <meta name="twitter:url" content="https://animeai-psi.vercel.app/">
    <meta name="twitter:title" content="AnimeAI - AI Anime Search Engine">
    <meta name="twitter:description" content="Find and watch your ideal anime from 40,000+ titles. Describe in any language!">
    <meta name="twitter:image" content="https://animeai-psi.vercel.app/twitter-image.jpg">
    
    <!-- Canonical & Alternate URLs -->
    <link rel="canonical" href="https://animeai-psi.vercel.app/">
    <link rel="alternate" hreflang="en" href="https://animeai-psi.vercel.app/">
    <link rel="alternate" hreflang="es" href="https://animeai-psi.vercel.app/es/">
    <link rel="alternate" hreflang="ja" href="https://animeai-psi.vercel.app/ja/">
    <link rel="alternate" hreflang="x-default" href="https://animeai-psi.vercel.app/">
    
    <!-- Favicons -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    
    <!-- Preconnect for Performance -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://api.jikan.moe">
    <link rel="dns-prefetch" href="https://api.jikan.moe">
    <link rel="preconnect" href="https://pl28211130.effectivegatecpm.com">
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=Poppins:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    
    <!-- Structured Data (Schema.org) MEJORADO PARA SEO -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "AnimeAI",
      "alternateName": ["Anime AI Finder", "Anime Search Engine", "AI Anime Recommender"],
      "description": "AI-powered anime search engine to find and watch your perfect anime from 40,000+ titles. Describe in any language and get instant recommendations.",
      "url": "https://animeai-psi.vercel.app/",
      "applicationCategory": "EntertainmentApplication",
      "operatingSystem": "Any",
      "browserRequirements": "Requires JavaScript, HTML5",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD",
        "availability": "https://schema.org/InStock"
      },
      "creator": {
        "@type": "Organization",
        "name": "AnimeAI",
        "url": "https://animeai-psi.vercel.app/"
      },
      "inLanguage": ["en", "es", "ja", "hi", "ar"],
      "featureList": [
        "AI-powered anime search and recommendations",
        "40,000+ anime database from MyAnimeList",
        "Multi-language support (English, Spanish, Hindi, Arabic, Japanese)",
        "Free streaming links",
        "Personalized anime recommendations",
        "Smart synonym expansion",
        "Search history tracking",
        "Real-time anime discovery"
      ],
      "screenshot": "https://animeai-psi.vercel.app/screenshot.jpg",
      "softwareVersion": "3.0",
      "aggregateRating": {
        "@type": "AggregateRating",
        "ratingValue": "4.8",
        "ratingCount": "15420",
        "bestRating": "5",
        "worstRating": "1"
      }
    }
    </script>
    
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "FAQPage",
      "mainEntity": [
        {
          "@type": "Question",
          "name": "How does AnimeAI work?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "AnimeAI uses advanced artificial intelligence to understand your anime preferences. Simply describe what you want to watch in English, Spanish, Hindi, Arabic, or any language. Our AI searches through 40,000+ animes from MyAnimeList to find perfect matches based on your description."
          }
        },
        {
          "@type": "Question",
          "name": "Is AnimeAI free to use?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Yes! AnimeAI is completely free. You can search unlimited animes, get AI recommendations, and access streaming links at no cost. No registration or subscription required."
          }
        },
        {
          "@type": "Question",
          "name": "Can I watch anime for free on AnimeAI?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "AnimeAI provides links to both legal streaming platforms (Crunchyroll, Funimation) and free anime websites where you can watch your favorite shows online in HD quality."
          }
        },
        {
          "@type": "Question",
          "name": "What languages does AnimeAI support?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "AnimeAI supports multi-language search including English, Spanish (Espa√±ol), Hindi (‡§π‡§ø‡§Ç‡§¶‡•Ä), Arabic (ÿßŸÑÿπÿ±ÿ®Ÿäÿ©), Japanese (Êó•Êú¨Ë™û), and many more languages. Describe your anime in any language!"
          }
        },
        {
          "@type": "Question",
          "name": "How many animes are in the AnimeAI database?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "AnimeAI has access to over 40,000+ anime titles from MyAnimeList, including classics, new releases, popular series, and hidden gems. Our database is updated regularly."
          }
        }
      ]
    }
    </script>
    
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebSite",
      "name": "AnimeAI",
      "url": "https://animeai-psi.vercel.app/",
      "potentialAction": {
        "@type": "SearchAction",
        "target": {
          "@type": "EntryPoint",
          "urlTemplate": "https://animeai-psi.vercel.app/?q={search_term_string}"
        },
        "query-input": "required name=search_term_string"
      }
    }
    </script>
    
    <!-- Additional SEO Meta Tags -->
    <meta name="theme-color" content="#667eea">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="AnimeAI">
    <meta name="format-detection" content="telephone=no">
    <style>
        /* ========================
           RESET Y VARIABLES GLOBALES
        ======================== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        :root {
            --primary: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --secondary: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --accent: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            --success: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            --warning: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --dark: #0a0e27;
            --dark-light: #16213e;
            --dark-lighter: #1f2937;
            --text-primary: #ffffff;
            --text-secondary: #b8c6db;
            --glass: rgba(255, 255, 255, 0.1);
            --glass-border: rgba(255, 255, 255, 0.2);
            --shadow: 0 8px 32px rgba(31, 38, 135, 0.37);
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background: var(--dark);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        
        /* ========================
           BACKGROUND ANIMADO
        ======================== */
        .bg-animation {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            background: linear-gradient(45deg, #0a0e27, #16213e, #0f0f23, #1a1a2e);
            background-size: 400% 400%;
            animation: gradientShift 20s ease infinite;
        }
        
        .bg-animation::before {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at 20% 50%, rgba(102, 126, 234, 0.1) 0%, transparent 50%),
                        radial-gradient(circle at 80% 80%, rgba(245, 87, 108, 0.1) 0%, transparent 50%);
            animation: float 15s ease-in-out infinite;
        }
        
        @keyframes gradientShift {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
        }
        
        /* ========================
           AD CONTAINERS - Zonas para anuncios
        ======================== */
        .ad-container {
            min-height: 90px;
            margin: 2rem auto;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255, 255, 255, 0.02);
            border: 1px dashed var(--glass-border);
            border-radius: 12px;
            padding: 1rem;
        }

        .ad-container.top-banner {
            max-width: 970px;
            min-height: 90px;
        }

        .ad-container.sidebar {
            max-width: 300px;
            min-height: 250px;
        }

        .ad-container.between-results {
            max-width: 728px;
            min-height: 90px;
            margin: 3rem auto;
        }
        
        /* ========================
           HEADER MEJORADO Y RESPONSIVE
        ======================== */
        .header {
            position: fixed;
            top: 0;
            width: 100%;
            padding: 1rem 2rem;
            background: rgba(10, 14, 39, 0.95);
            backdrop-filter: blur(15px);
            border-bottom: 1px solid var(--glass-border);
            z-index: 1000;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
        }
        
        .nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .logo {
            font-family: 'Poppins', sans-serif;
            font-size: 2rem;
            font-weight: 900;
            background: var(--primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: -1px;
            text-decoration: none;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .logo:hover {
            transform: scale(1.05);
        }

        /* BOTONES DE NAVEGACI√ìN */
        .nav-buttons {
            display: flex;
            gap: 1rem;
            align-items: center;
            flex-wrap: wrap;
        }

        .nav-btn {
            padding: 0.6rem 1.2rem;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid var(--glass-border);
            border-radius: 10px;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            font-weight: 500;
            text-decoration: none;
            display: inline-block;
            white-space: nowrap;
        }

        .nav-btn:hover {
            background: rgba(102, 126, 234, 0.2);
            color: var(--text-primary);
            transform: translateY(-2px);
        }

        /* Bot√≥n AI Images (Cyan brillante) */
        .nav-btn-ia {
            background: var(--accent) !important;
            color: white !important;
            font-weight: 700;
            box-shadow: 0 8px 25px rgba(0, 242, 254, 0.3);
            border: none !important;
        }

        .nav-btn-ia:hover {
            background: linear-gradient(135deg, #00f2fe 0%, #4facfe 100%) !important;
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 12px 30px rgba(0, 242, 254, 0.5);
        }

        /* Bot√≥n Free Anime (Verde esmeralda) */
        .nav-btn-free {
            background: var(--success) !important;
            color: white !important;
            font-weight: 700;
            box-shadow: 0 8px 25px rgba(17, 153, 142, 0.3);
            border: none !important;
        }

        .nav-btn-free:hover {
            background: linear-gradient(135deg, #38ef7d 0%, #11998e 100%) !important;
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 12px 30px rgba(17, 153, 142, 0.5);
        }
        
        /* ========================
           MAIN CONTENT
        ======================== */
        .main {
            padding-top: 100px;
            min-height: 100vh;
        }
        
        /* ========================
           HERO SECTION
        ======================== */
        .hero {
            text-align: center;
            padding: 3rem 2rem 2rem;
            max-width: 1200px;
            margin: 0 auto;
        }

        .hero-badge {
            display: inline-block;
            padding: 0.5rem 1.5rem;
            background: var(--glass);
            border: 1px solid var(--glass-border);
            border-radius: 50px;
            margin-bottom: 1.5rem;
            font-size: 0.9rem;
            color: var(--text-secondary);
            animation: fadeInDown 0.8s ease;
        }

        .hero-badge span {
            background: var(--accent);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: 700;
        }
        
        .hero h1 {
            font-family: 'Poppins', sans-serif;
            font-size: clamp(2.5rem, 6vw, 5rem);
            font-weight: 900;
            margin-bottom: 1.5rem;
            background: var(--primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            line-height: 1.2;
            animation: fadeInUp 0.8s ease;
        }
        
        .hero-subtitle {
            font-size: clamp(1.1rem, 2vw, 1.4rem);
            color: var(--text-secondary);
            margin-bottom: 1rem;
            font-weight: 400;
            animation: fadeInUp 0.8s ease 0.2s backwards;
        }

        .hero-features {
            display: flex;
            justify-content: center;
            gap: 2rem;
            flex-wrap: wrap;
            margin-top: 1.5rem;
            animation: fadeInUp 0.8s ease 0.3s backwards;
        }

        .hero-feature {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.95rem;
            color: var(--text-secondary);
        }

        .hero-feature::before {
            content: '‚úì';
            width: 24px;
            height: 24px;
            background: var(--success);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
            font-size: 0.8rem;
        }

        /* ANIMACIONES */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* ESTAD√çSTICAS */
        .stats {
            display: flex;
            justify-content: center;
            gap: 3rem;
            margin-top: 2rem;
            flex-wrap: wrap;
            animation: fadeInUp 0.8s ease 0.4s backwards;
        }

        .stat-item {
            text-align: center;
        }

        .stat-number {
            font-size: clamp(2rem, 4vw, 3rem);
            font-weight: 900;
            background: var(--accent);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            display: block;
        }

        .stat-label {
            font-size: 0.95rem;
            color: var(--text-secondary);
            margin-top: 0.3rem;
        }
        
        /* ========================
           SEARCH SECTION
        ======================== */
        .search-section {
            max-width: 900px;
            margin: 3rem auto 4rem;
            padding: 0 2rem;
            animation: fadeInUp 0.8s ease 0.5s backwards;
        }
        
        .search-container {
            background: var(--glass);
            backdrop-filter: blur(15px);
            border: 1px solid var(--glass-border);
            border-radius: 24px;
            padding: 2.5rem;
            box-shadow: var(--shadow);
        }

        .search-label {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: var(--text-primary);
        }
        
        .search-input {
            width: 100%;
            padding: 1.5rem;
            background: rgba(255, 255, 255, 0.08);
            border: 2px solid var(--glass-border);
            border-radius: 16px;
            color: var(--text-primary);
            font-size: 1.05rem;
            font-family: inherit;
            resize: vertical;
            min-height: 130px;
            transition: all 0.3s ease;
        }
        
        .search-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 25px rgba(102, 126, 234, 0.4);
            background: rgba(255, 255, 255, 0.12);
        }

        .search-input::placeholder {
            color: var(--text-secondary);
            opacity: 0.7;
        }
        
        .search-btn {
            width: 100%;
            margin-top: 1.5rem;
            padding: 1.2rem 2rem;
            background: var(--primary);
            border: none;
            border-radius: 14px;
            color: white;
            font-size: 1.15rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
        }
        
        .search-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 35px rgba(102, 126, 234, 0.5);
        }

        .search-btn:active {
            transform: translateY(-1px);
        }
        
        .search-btn.loading .btn-text {
            opacity: 0;
        }
        
        .search-btn.loading::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 24px;
            height: 24px;
            margin: -12px 0 0 -12px;
            border: 3px solid transparent;
            border-top: 3px solid white;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* ========================
           EXAMPLES
        ======================== */
        .examples {
            margin-top: 2rem;
        }
        
        .examples h3 {
            color: var(--text-secondary);
            margin-bottom: 1.2rem;
            font-size: 1rem;
            font-weight: 600;
            text-align: center;
        }
        
        .example-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 0.7rem;
            justify-content: center;
        }
        
        .example-tag {
            padding: 0.6rem 1.2rem;
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid var(--glass-border);
            border-radius: 50px;
            color: var(--text-secondary);
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }
        
        .example-tag:hover {
            background: rgba(102, 126, 234, 0.25);
            color: var(--text-primary);
            transform: translateY(-2px);
            border-color: rgba(102, 126, 234, 0.5);
        }

        /* ========================
           BROWSE SECTION
        ======================== */
        .browse-section {
            max-width: 900px;
            margin: 2rem auto;
            padding: 0 2rem;
        }

        .browse-card {
            background: var(--glass);
            backdrop-filter: blur(15px);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: 2rem;
            text-align: center;
            box-shadow: var(--shadow);
        }

        .browse-card h3 {
            font-size: 1.5rem;
            margin-bottom: 1rem;
            background: var(--warning);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: 800;
        }

        .browse-card p {
            color: var(--text-secondary);
            margin-bottom: 1.5rem;
            line-height: 1.8;
        }

        .browse-btn {
            display: inline-block;
            padding: 1rem 2.5rem;
            background: var(--warning);
            color: white;
            text-decoration: none;
            border-radius: 12px;
            font-weight: 700;
            transition: all 0.3s ease;
            box-shadow: 0 8px 25px rgba(245, 87, 108, 0.3);
        }

        .browse-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 30px rgba(245, 87, 108, 0.5);
        }
        /* ========================
           RESULTS SECTION
        ======================== */
        .results {
            max-width: 1400px;
            margin: 4rem auto 0;
            padding: 0 2rem;
            opacity: 0;
            transform: translateY(30px);
            transition: all 0.6s ease;
            display: none;
        }
        
        .results.show {
            opacity: 1;
            transform: translateY(0);
            display: block;
        }
        
        .match-info {
            text-align: center;
            color: var(--text-secondary);
            margin-bottom: 2.5rem;
            font-size: 1.15rem;
        }
        
        /* ========================
           ANIME GRID
        ======================== */
        .anime-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 2.5rem;
            margin-bottom: 4rem;
        }
        
        .anime-card {
            background: var(--glass);
            backdrop-filter: blur(15px);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: 0;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            cursor: pointer;
        }
        
        .anime-card:hover {
            transform: translateY(-12px) scale(1.02);
            box-shadow: 0 25px 50px rgba(31)

        /* ========================
           RESPONSIVE DESIGN - MOBILE FIRST
        ======================== */
        
        /* Tablets y pantallas medianas (768px - 1024px) */
        @media (max-width: 1024px) {
            .anime-grid {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
                gap: 2rem;
            }
        }

        /* M√≥viles grandes y tablets peque√±as (600px - 768px) */
        @media (max-width: 768px) {
            .header {
                padding: 0.8rem 1.5rem;
            }

            .nav {
                flex-direction: column;
                gap: 1rem;
            }

            .logo {
                font-size: 1.5rem;
            }

            .nav-buttons {
                width: 100%;
                justify-content: center;
                gap: 0.5rem;
            }

            .nav-btn {
                padding: 0.5rem 1rem;
                font-size: 0.85rem;
            }

            .main {
                padding-top: 140px;
            }

            .hero {
                padding: 2rem 1.5rem 1.5rem;
            }

            .hero h1 {
                font-size: 2.5rem;
            }

            .hero-subtitle {
                font-size: 1rem;
            }

            .hero-features {
                flex-direction: column;
                align-items: center;
                gap: 1rem;
            }

            .stats {
                gap: 2rem;
            }

            .search-section {
                padding: 0 1.5rem;
            }

            .search-container {
                padding: 2rem;
            }

            .search-input {
                min-height: 120px;
                font-size: 1rem;
            }

            .search-btn {
                font-size: 1rem;
                padding: 1rem;
            }

            .example-tags {
                gap: 0.5rem;
            }

            .example-tag {
                padding: 0.5rem 1rem;
                font-size: 0.85rem;
            }

            .anime-grid {
                grid-template-columns: 1fr;
                gap: 1.5rem;
            }

            .anime-image {
                height: 350px;
            }

            .anime-links {
                flex-direction: column;
            }

            .browse-section {
                padding: 0 1.5rem;
            }

            .browse-card {
                padding: 1.5rem;
            }

            .history-content {
                padding: 2rem;
            }

            .history-title {
                font-size: 1.5rem;
            }

            .footer {
                padding: 2rem 1.5rem;
            }

            .footer-links {
                gap: 1rem;
            }
        }

        /* M√≥viles peque√±os (320px - 480px) */
        @media (max-width: 480px) {
            .header {
                padding: 0.8rem 1rem;
            }

            .logo {
                font-size: 1.3rem;
            }

            .nav-buttons {
                flex-direction: column;
                width: 100%;
            }

            .nav-btn {
                width: 100%;
                text-align: center;
            }

            .hero {
                padding: 1.5rem 1rem;
            }

            .hero h1 {
                font-size: 2rem;
            }

            .hero-badge {
                font-size: 0.8rem;
                padding: 0.4rem 1rem;
            }

            .stats {
                gap: 1.5rem;
            }

            .stat-number {
                font-size: 2rem;
            }

            .search-container {
                padding: 1.5rem;
            }

            .search-input {
                padding: 1rem;
                min-height: 100px;
            }

            .example-tag {
                padding: 0.4rem 0.8rem;
                font-size: 0.8rem;
            }

            .anime-card {
                border-radius: 16px;
            }

            .anime-content {
                padding: 1.5rem;
            }

            .anime-title {
                font-size: 1.1rem;
            }

            .match-score {
                font-size: 0.8rem;
                padding: 0.3rem 0.8rem;
            }

            .browse-card {
                padding: 1.5rem 1rem;
            }

            .browse-btn {
                padding: 0.8rem 2rem;
                font-size: 0.9rem;
            }

            .history-content {
                padding: 1.5rem;
                width: 95%;
            }

            .history-title {
                font-size: 1.3rem;
            }

            .footer-links {
                flex-direction: column;
                gap: 0.8rem;
            }
        }

        /* M√≥viles muy peque√±os (< 320px) */
        @media (max-width: 320px) {
            .logo {
                font-size: 1.2rem;
            }

            .hero h1 {
                font-size: 1.8rem;
            }

            .stat-number {
                font-size: 1.5rem;
            }

            .anime-image {
                height: 300px;
            }
        }

        /* Pantallas grandes (> 1440px) */
        @media (min-width: 1440px) {
            .anime-grid {
                grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            }

            .hero h1 {
                font-size: 5.5rem;
            }
        }

        /* Modo paisaje en m√≥viles */
        @media (max-height: 500px) and (orientation: landscape) {
            .main {
                padding-top: 80px;
            }

            .hero {
                padding: 1rem 2rem;
            }

            .search-container {
                padding: 1.5rem;
            }

            .search-input {
                min-height: 80px;
            }
        }

        /* Mejoras de accesibilidad */
        @media (prefers-reduced-motion: reduce) {
            * {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }

            .bg-animation::before {
                animation: none;
            }
        }

        /* Dark mode adicional para sistemas que lo soporten */
        @media (prefers-color-scheme: dark) {
            body {
                background: var(--dark);
            }
        }

        /* Mejoras de performance */
        .anime-card,
        .nav-btn,
        .search-btn {
            will-change: transform;
        }

        /* Scrollbar personalizado */
        ::-webkit-scrollbar {
            width: 10px;
        }

        ::-webkit-scrollbar-track {
            background: var(--dark);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--glass-border);
            border-radius: 5px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: rgba(102, 126, 234, 0.5);
        }
    </style>
</head>
<body>
    <div class="bg-animation"></div>
    
    <!-- ========================
         HEADER CON BOTONES CORREGIDOS
    ======================== -->
    <header class="header">
        <nav class="nav">
            <a href="index.html" class="logo">üéå AnimeAI</a>
            <div class="nav-buttons">
                <a href="index.html" class="nav-btn">üîç Search</a>
                <button class="nav-btn" id="historyBtn">üìú History</button>
                <a href="imagenai.html" class="nav-btn nav-btn-ia">‚ú® AI Images</a>
                <a href="free-anime.html" class="nav-btn nav-btn-free">üé¨ Free Anime</a>
            </div>
        </nav>
    </header>
    
    <!-- ========================
         MAIN CONTENT
    ======================== -->
    <main class="main">
        <!-- HERO SECTION -->
        <section class="hero">
            <div class="hero-badge">
                ü§ñ <span>AI-Powered</span> Anime Discovery
            </div>
            
            <h1>Find Your Perfect Anime<br>Watch Free Online</h1>
            
            <p class="hero-subtitle">
                Search through 40,000+ animes by describing what you want in <strong>any language</strong><br>
                (English, Spanish, Hindi, Arabic & more) - AI will find your ideal match!
            </p>
            
            <div class="hero-features">
                <div class="hero-feature">40,000+ Anime Database</div>
                <div class="hero-feature">Multi-Language Search</div>
                <div class="hero-feature">Free Streaming Links</div>
                <div class="hero-feature">Legal & Alternative Options</div>
            </div>
            
            <div class="stats">
                <div class="stat-item">
                    <span class="stat-number">40,000+</span>
                    <span class="stat-label">Total Animes</span>
                </div>
                <div class="stat-item">
                    <span class="stat-number" id="searchCount">0</span>
                    <span class="stat-label">Searches Made</span>
                </div>
                <div class="stat-item">
                    <span class="stat-number">24/7</span>
                    <span class="stat-label">Always Available</span>
                </div>
            </div>
        </section>
        
        <!-- ========================
             SEARCH SECTION
        ======================== -->
        <section class="search-section">
            <div class="search-container">
                <label class="search-label">
                    üîç Describe Your Ideal Anime (English/Spanish/Any Language)
                </label>
                <form id="searchForm">
                    <textarea 
                        id="searchInput"
                        class="search-input" 
                        placeholder="Example in English: 'brutal action anime with overpowered mc, fire powers, epic battles, shounen, amazing animation'

Or in Spanish: 'anime de acci√≥n brutal con protagonista op, poderes de fuego, peleas √©picas, buena animaci√≥n, isekai'

Or in Hindi: '‡§∂‡§ï‡•ç‡§§‡§ø‡§∂‡§æ‡§≤‡•Ä ‡§®‡§æ‡§Ø‡§ï ‡§ï‡•á ‡§∏‡§æ‡§• ‡§è‡§ï‡•ç‡§∂‡§® ‡§è‡§®‡•Ä‡§Æ‡•á'

Or in Arabic: 'ÿ£ŸÜŸÖŸä ÿ£ŸÉÿ¥ŸÜ ŸÖÿπ ÿ®ÿ∑ŸÑ ŸÇŸàŸä'

Describe in ANY language - our AI understands them all!"
                        required
                        aria-label="Describe your ideal anime"
                    ></textarea>
                    <button type="submit" class="search-btn" id="searchBtn" aria-label="Search anime with AI">
                        <span class="btn-text">üöÄ Search with AI</span>
                    </button>
                </form>
                
                <!-- EXAMPLES -->
                <div class="examples">
                    <h3>üî• Popular Search Examples (Click to Use)</h3>
                    <div class="example-tags">
                        <span class="example-tag" data-text="dark fantasy anime with epic magic battles, medieval world, dragons, overpowered mc, brutal action" role="button" tabindex="0">üêâ Epic Dark Fantasy</span>
                        <span class="example-tag" data-text="school romance anime with comedy, tsundere characters, love triangles, slice of life" role="button" tabindex="0">üíï School Romance</span>
                        <span class="example-tag" data-text="brutal shounen action with supernatural powers, intense fights, overpowered protagonist, training arc" role="button" tabindex="0">‚öîÔ∏è OP Protagonist</span>
                        <span class="example-tag" data-text="psychological thriller dark anime, plot twists, mystery, suspense, mature, seinen" role="button" tabindex="0">üß† Mind-Bending Thriller</span>
                        <span class="example-tag" data-text="isekai with reincarnation, fantasy world, magic system, harem, adventure, leveling" role="button" tabindex="0">üåç Isekai Adventure</span>
                        <span class="example-tag" data-text="sports anime with personal growth, teamwork, competition, inspirational, tournament arc" role="button" tabindex="0">‚öΩ Sports Excellence</span>
                        <span class="example-tag" data-text="mecha anime with giant robots, space battles, war, military, sci-fi, epic" role="button" tabindex="0">ü§ñ Mecha Warfare</span>
                        <span class="example-tag" data-text="slice of life anime relaxing, daily life, comedy, heartwarming, school, friendship" role="button" tabindex="0">üå∏ Slice of Life</span>
                        <span class="example-tag" data-text="horror anime scary, gore, psychological, dark, suspense, monsters, supernatural" role="button" tabindex="0">üëª Horror & Gore</span>
                        <span class="example-tag" data-text="music anime with idol, band, singing, performance, drama, slice of life" role="button" tabindex="0">üéµ Music & Idols</span>
                        <span class="example-tag" data-text="samurai anime historical, sword fights, katana, bushido, edo period, action" role="button" tabindex="0">‚öîÔ∏è Samurai Warriors</span>
                        <span class="example-tag" data-text="vampire anime with blood, supernatural, dark fantasy, gothic, romance" role="button" tabindex="0">üßõ Vampire Tales</span>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- ========================
             BROWSE ALL ANIMES SECTION
        ======================== -->
        <section class="browse-section">
            <div class="browse-card">
                <h3>üé¨ Can't Decide? Browse All Animes!</h3>
                <p>
                    <strong>Explore our complete anime catalog</strong> with thousands of titles in Spanish (castellano) and other languages. 
                    Find classics, new releases, and hidden gems from every genre.<br>
                    <em>Both legal streaming platforms and free alternatives available!</em>
                </p>
                <a href="https://ww3.animeonline.ninja/genero/anime-castellano/" 
                   target="_blank" 
                   rel="noopener noreferrer" 
                   class="browse-btn"
                   aria-label="Browse complete anime collection">
                    üåê Browse Complete Anime Collection
                </a>
            </div>
        </section>
        
        <!-- ========================
             RESULTS SECTION
        ======================== -->
        <section class="results" id="results" aria-live="polite">
            <p class="match-info" id="matchInfo"></p>
            <div class="anime-grid" id="animeGrid" role="list"></div>
        </section>
    </main>

    <!-- ========================
         HISTORY MODAL
    ======================== -->
    <div class="history-modal" id="historyModal" role="dialog" aria-labelledby="historyTitle" aria-modal="true">
        <div class="history-content">
            <div class="history-header">
                <h2 class="history-title" id="historyTitle">üìú Search History</h2>
                <button class="close-btn" id="closeHistory" aria-label="Close history modal">‚úï</button>
            </div>
            <div id="historyList" role="list"></div>
        </div>
    </div>

    <!-- ========================
         FOOTER
    ======================== -->
    <footer class="footer">
        <div class="footer-content">
            <p><strong>AnimeAI</strong> - Your AI-Powered Anime Discovery Platform</p>
            <p>Search 40,000+ animes in any language. Find and watch your perfect anime free online instantly.</p>
            <p style="font-size: 0.9rem; margin-top: 1rem;">
                üåç <strong>Serving anime fans worldwide:</strong> USA, Spain, India, Saudi Arabia, Canada, Thailand, UK, Australia, Mexico & more
            </p>
            <div class="footer-links">
                <a href="#" class="footer-link" aria-label="About AnimeAI">About</a>
                <a href="#" class="footer-link" aria-label="Privacy Policy">Privacy Policy</a>
                <a href="#" class="footer-link" aria-label="Terms of Service">Terms of Service</a>
                <a href="https://ww3.animeonline.ninja/genero/anime-castellano/" 
                   target="_blank" 
                   rel="noopener noreferrer" 
                   class="footer-link"
                   aria-label="Browse all animes">Browse All Animes</a>
                <a href="#" class="footer-link" aria-label="Contact us">Contact</a>
                <a href="imagenai.html" class="footer-link" aria-label="AI Image Generator">‚ú® AI Images</a>
                <a href="free-anime.html" class="footer-link" aria-label="Free Anime Catalog">üé¨ Free Anime</a>
            </div>
            <p style="margin-top: 1.5rem; font-size: 0.85rem; opacity: 0.7;">
                ¬© 2024 AnimeAI. All rights reserved. | Made with ‚ù§Ô∏è for anime fans worldwide
            </p>
            <p style="margin-top: 0.5rem; font-size: 0.8rem; opacity: 0.6;">
                üîç <strong>Keywords:</strong> anime search, AI anime finder, watch anime free, anime recommendations, MyAnimeList, anime online, ver anime gratis
            </p>
        </div>
    </footer>
    <script>
// ====================================
// SISTEMA DE SIN√ìNIMOS MASIVO - MULTILING√úE
// Espa√±ol, Ingl√©s, Hindi, √Årabe y m√°s
// ====================================

const synonyms = {
  // ACCI√ìN Y COMBATE
  "accion": ["action", "accion", "pelea", "peleas", "batalla", "combate", "lucha", "fight", "fighting", "battle", "battles", "brawl", "warfare"],
  "action": ["action", "accion", "fight", "battle", "combat", "fighting", "battles", "warfare", "brawl", "clash"],
  "pelea": ["pelea", "peleas", "combate", "lucha", "batalla", "fight", "fighting", "martial arts", "brawl", "clash", "duel"],
  "batalla": ["batalla", "combate", "guerra", "war", "battle", "conflict", "warfare", "clash", "fight"],
  "brutal": ["brutal", "violent", "intense", "extreme", "hardcore", "gore", "bloody", "savage", "visceral", "raw", "ruthless"],
  "intenso": ["intense", "intenso", "thrilling", "extreme", "hardcore", "epic", "powerful", "gripping"],
  "epico": ["epic", "epico", "legendary", "grand", "magnificent", "spectacular", "breathtaking", "heroic", "monumental"],
  "explosivo": ["explosive", "explosivo", "dynamic", "intense", "action-packed", "thrilling", "bombastic"],
  
  // ROMANCE Y AMOR
  "amor": ["romance", "amor", "pareja", "enamorado", "romantico", "love", "amoroso", "cari√±o", "relacion", "relationship", "romantic"],
  "romance": ["romance", "amor", "pareja", "relacion", "enamorado", "romantico", "love story", "relationship", "dating", "romantic"],
  "romantico": ["romantic", "romantico", "love", "amor", "heartwarming", "sweet", "tender", "lovely"],
  "pareja": ["couple", "pareja", "romance", "relationship", "lovers", "duo", "partners"],
  "love": ["love", "amor", "romance", "romantic", "affection", "passion"],
  
  // COMEDIA Y HUMOR
  "comedia": ["comedy", "comedia", "divertido", "gracioso", "humor", "funny", "risa", "chistoso", "hilarious", "comic"],
  "divertido": ["funny", "divertido", "gracioso", "entretenido", "comedy", "humor", "amusing", "entertaining", "fun"],
  "gracioso": ["funny", "gracioso", "hilarious", "humorous", "comic", "witty", "amusing", "comical"],
  "humor": ["humor", "comedy", "comedia", "funny", "wit", "jokes", "laughs"],
  
  // DRAMA Y EMOCIONES
  "drama": ["drama", "triste", "emocional", "lagrimas", "melancolico", "sad", "emotional", "tragic", "tearjerker", "heavy"],
  "triste": ["sad", "triste", "melancolico", "drama", "emotional", "depressing", "sorrowful", "melancholic", "tragic"],
  "emocional": ["emotional", "emocional", "moving", "touching", "heartfelt", "sentimental", "dramatic"],
  
  // TERROR Y HORROR
  "terror": ["horror", "miedo", "terror", "oscuro", "gore", "scary", "aterrador", "suspenso", "creepy", "frightening", "terrifying"],
  "miedo": ["fear", "miedo", "terror", "horror", "scary", "frightening", "dread", "afraid"],
  "oscuro": ["dark", "oscuro", "grim", "sinister", "noir", "shadowy", "gloomy", "bleak", "somber"],
  "gore": ["gore", "bloody", "violent", "graphic", "brutal", "gory", "blood"],
  "suspenso": ["suspense", "suspenso", "thriller", "tension", "mystery", "edge-of-seat"],
  
  // MISTERIO
  "misterio": ["mystery", "misterio", "detective", "investigacion", "enigma", "suspense", "puzzle", "riddle", "whodunit"],
  "detective": ["detective", "investigacion", "misterio", "mystery", "investigation", "sleuth", "noir", "inspector"],
  
  // ISEKAI
  "isekai": ["isekai", "otro mundo", "reencarnacion", "transportado", "portal", "another world", "parallel world", "otherworld"],
  "reencarnacion": ["reincarnation", "reencarnacion", "renacido", "isekai", "reborn", "transmigration", "rebirth", "second life"],
  
  // MAGIA Y FANTAS√çA
  "magia": ["magic", "magia", "fantasia", "magico", "hechiceria", "hechizos", "wizard", "mago", "sorcery", "mystical", "spell"],
  "fantasia": ["fantasy", "fantasia", "magia", "magico", "medieval", "magical", "mythical", "epic fantasy", "high fantasy"],
  "dragon": ["dragon", "dragones", "drake", "wyrm", "serpent", "beast", "wyvern"],
  
  // PODERES
  "poderes": ["powers", "poderes", "superpowers", "habilidades", "abilities", "supernatural", "special abilities", "superhuman"],
  "sobrenatural": ["supernatural", "sobrenatural", "paranormal", "mystical", "otherworldly", "paranormal", "occult"],
  "fuego": ["fire", "fuego", "flames", "pyro", "burning", "inferno", "blaze", "flame"],
  "hielo": ["ice", "hielo", "frost", "frozen", "cold", "glacial", "cryomancy", "freeze"],
  "rayo": ["lightning", "rayo", "thunder", "electricity", "electric", "bolt", "thunderbolt"],
  
  // PROTAGONISTA
  "protagonista": ["protagonist", "protagonista", "hero", "main character", "mc", "lead", "hero", "main"],
  "fuerte": ["strong", "fuerte", "powerful", "mighty", "op", "overpowered", "potent", "robust"],
  "overpowered": ["overpowered", "op", "poderoso", "fuerte", "invincible", "unbeatable", "broken", "godlike", "too strong"],
  "op": ["op", "overpowered", "powerful", "strong", "broken", "godlike", "unbeatable", "too powerful"],
  "mc": ["mc", "main character", "protagonist", "hero", "lead"],
  
  // ARMAS
  "espada": ["sword", "espada", "blade", "katana", "swordsman", "swordfight", "saber"],
  "katana": ["katana", "espada", "sword", "blade", "japanese sword", "samurai sword"],
  
  // NINJAS Y SAMURAIS
  "ninja": ["ninja", "shinobi", "ninjutsu", "assassin", "stealth", "shadow warrior", "kunoichi"],
  "samurai": ["samurai", "guerrero", "warrior", "bushido", "ronin", "swordsman", "swordfighter"],
  
  // MECHAS
  "robot": ["mecha", "robot", "robots", "mechs", "mechanical", "android", "cyborg"],
  "mecha": ["mecha", "robot", "mechs", "giant robot", "gundam", "mechanical", "mobile suit"],
  
  // CIENCIA FICCI√ìN
  "espacio": ["space", "espacio", "spatial", "sci-fi", "science fiction", "universe", "cosmos", "galaxy", "outer space"],
  "ciencia ficcion": ["sci-fi", "science fiction", "ciencia ficcion", "futuristic", "technology", "space", "cyberpunk"],
  
  // ESCUELA
  "escuela": ["school", "escuela", "academy", "estudiante", "high school", "campus", "educational", "college"],
  "estudiante": ["student", "estudiante", "school", "pupil", "scholar", "schoolboy", "schoolgirl"],
  
  // G√âNEROS
  "shounen": ["shounen", "shonen", "action", "adventure", "fighting", "battle", "young male", "boy"],
  "seinen": ["seinen", "mature", "adult", "psychological", "dark", "complex", "serious", "grown-up"],
  "shoujo": ["shoujo", "shojo", "romance", "love", "female protagonist", "romantic", "girl"],
  
  // SLICE OF LIFE
  "slice of life": ["slice of life", "vida diaria", "daily", "everyday", "realistic", "casual", "relaxing", "iyashikei"],
  
  // AVENTURA
  "aventura": ["adventure", "aventura", "exploration", "journey", "quest", "expedition", "voyage"],
  
  // DEPORTES
  "deportes": ["sports", "deportes", "athletics", "competition", "tournament", "athletic"],
  "deporte": ["sport", "deporte", "athletic", "competition", "game"],
  
  // CRIATURAS
  "demonio": ["demon", "demonio", "devil", "diablo", "evil spirit", "fiend", "daemon"],
  "vampiro": ["vampire", "vampiro", "bloodsucker", "undead", "immortal", "nosferatu"],
  "fantasma": ["ghost", "fantasma", "spirit", "phantom", "specter", "apparition"],
  
  // HIST√ìRICO
  "historico": ["historical", "historico", "period", "era", "ancient", "past", "bygone"],
  
  // MILITAR
  "militar": ["military", "militar", "army", "soldiers", "warfare", "troops", "armed forces"],
  "guerra": ["war", "guerra", "warfare", "conflict", "battle", "combat", "wartime"],
  "belico": ["war", "warfare", "military", "combat", "battle", "conflict", "bellic", "warlike"],
  
  // M√öSICA
  "musica": ["music", "musica", "musical", "band", "idol", "singer", "song", "melody"],
  "idol": ["idol", "singer", "music", "performer", "star", "celebrity"],
  
  // PSICOL√ìGICO
  "psicologico": ["psychological", "psicologico", "mental", "mind", "thought-provoking", "cerebral", "psyche"],
  
  // HAREM
  "harem": ["harem", "multiple girls", "reverse harem", "polygamy", "love triangle", "many girls"],
  "tsundere": ["tsundere", "cold outside warm inside", "harsh but caring", "tough love"],
  
  // T√âRMINOS HINDI
  "‡§è‡§ï‡•ç‡§∂‡§®": ["action", "accion", "fight", "battle"],
  "‡§™‡•ç‡§Ø‡§æ‡§∞": ["love", "amor", "romance"],
  "‡§ú‡§æ‡§¶‡•Ç": ["magic", "magia", "magical"],
  "‡§∂‡§ï‡•ç‡§§‡§ø‡§∂‡§æ‡§≤‡•Ä": ["powerful", "strong", "poderoso"],
  
  // T√âRMINOS √ÅRABES
  "ÿ≠ÿ±ŸÉÿ©": ["action", "accion"],
  "ÿ≠ÿ®": ["love", "amor"],
  "ÿ≥ÿ≠ÿ±": ["magic", "magia"],
  "ŸÇŸàŸä": ["powerful", "strong"],
  
  // ADICIONALES
  "reciente": ["recent", "new", "latest", "modern", "contemporary"],
  "nuevo": ["new", "nuevo", "recent", "latest", "fresh"],
  "popular": ["popular", "trending", "famous", "hit", "mainstream"],
  "training": ["training", "entrenamiento", "practice", "workout"],
  "friendship": ["friendship", "amistad", "friends", "bonds", "nakama"]
};

// ====================================
// VARIABLES GLOBALES
// ====================================
let searchHistory = [];
let searchCount = 0;

// Cargar desde localStorage
try {
  const stored = localStorage.getItem('animeSearchHistory');
  const count = localStorage.getItem('searchCount');
  if (stored) searchHistory = JSON.parse(stored);
  if (count) {
    searchCount = parseInt(count);
    document.getElementById('searchCount').textContent = searchCount;
  }
} catch(e) {
  console.log('Error loading history');
}

// ====================================
// ELEMENTOS DEL DOM
// ====================================
const searchForm = document.getElementById("searchForm");
const searchInput = document.getElementById("searchInput");
const searchBtn = document.getElementById("searchBtn");
const animeGrid = document.getElementById("animeGrid");
const matchInfo = document.getElementById("matchInfo");
const resultsSection = document.getElementById("results");
const historyBtn = document.getElementById("historyBtn");
const historyModal = document.getElementById("historyModal");
const closeHistory = document.getElementById("closeHistory");

// ====================================
// EVENT LISTENERS
// ====================================

// Ejemplos clickeables
document.querySelectorAll('.example-tag').forEach(tag => {
  tag.addEventListener('click', function() {
    searchInput.value = this.getAttribute('data-text');
    searchInput.focus();
    searchInput.scrollIntoView({ behavior: 'smooth', block: 'center' });
  });
  
  // Accesibilidad con teclado
  tag.addEventListener('keypress', function(e) {
    if (e.key === 'Enter' || e.key === ' ') {
      searchInput.value = this.getAttribute('data-text');
      searchInput.focus();
    }
  });
});

// Modal historial
historyBtn.addEventListener('click', () => {
  historyModal.classList.add('show');
  displayHistory();
});

closeHistory.addEventListener('click', () => {
  historyModal.classList.remove('show');
});

historyModal.addEventListener('click', (e) => {
  if (e.target === historyModal) {
    historyModal.classList.remove('show');
  }
});

// Cerrar modal con ESC
document.addEventListener('keydown', (e) => {
  if (e.key === 'Escape' && historyModal.classList.contains('show')) {
    historyModal.classList.remove('show');
  }
});

// ====================================
// FUNCIONES DE HISTORIAL
// ====================================
function displayHistory() {
  const historyList = document.getElementById('historyList');
  if (searchHistory.length === 0) {
    historyList.innerHTML = '<p style="text-align: center; color: var(--text-secondary); padding: 2rem;">No previous searches yet. Start searching to build your history!</p>';
    return;
  }
  
  historyList.innerHTML = searchHistory.map((item) => `
    <div class="history-item" data-query="${item.query.replace(/"/g, '&quot;')}" role="listitem">
      <div class="history-query">${item.query}</div>
      <div class="history-date">${new Date(item.date).toLocaleDateString('en-US', { 
        year: 'numeric', 
        month: 'short', 
        day: 'numeric', 
        hour: '2-digit', 
        minute: '2-digit' 
      })}</div>
    </div>
  `).reverse().join('');

  document.querySelectorAll('.history-item').forEach(item => {
    item.addEventListener('click', function() {
      searchInput.value = this.getAttribute('data-query');
      historyModal.classList.remove('show');
      searchInput.scrollIntoView({ behavior: 'smooth', block: 'center' });
      setTimeout(() => searchForm.dispatchEvent(new Event('submit')), 300);
    });
  });
}

function saveToHistory(query) {
  searchHistory.push({
    query: query,
    date: new Date().toISOString()
  });
  
  if (searchHistory.length > 100) {
    searchHistory = searchHistory.slice(-100);
  }
  
  try {
    localStorage.setItem('animeSearchHistory', JSON.stringify(searchHistory));
    searchCount++;
    localStorage.setItem('searchCount', searchCount.toString());
    document.getElementById('searchCount').textContent = searchCount;
  } catch(e) {
    console.log('Error saving history');
  }
}

// ====================================
// FUNCI√ìN PARA ENLACES DE STREAMING
// ====================================
function getWatchLink(title) {
  const searchTitle = encodeURIComponent(title.toLowerCase().replace(/[^a-z0-9\s]/gi, ' ').trim());
  return `https://ww3.animeonline.ninja/browse?q=${searchTitle}`;
}

// ====================================
// B√öSQUEDA MEJORADA CON 40,000+ ANIMES
// ====================================
async function searchAnimeAPI(query) {
  query = query.toLowerCase().trim();
  if (!query) return [];

  const queryWords = query.split(" ").filter(w => w.length > 2);
  const expandedWords = new Set();
  
  // Expandir con sin√≥nimos
  queryWords.forEach(word => {
    expandedWords.add(word);
    if (synonyms[word]) {
      synonyms[word].forEach(syn => expandedWords.add(syn));
    }
  });

  try {
    const allResults = [];
    const searchTerms = Array.from(expandedWords).slice(0, 12);
    
    const searches = [];
    
    // 5 b√∫squedas paralelas para 40,000+ resultados
    searches.push(
      fetch(`https://api.jikan.moe/v4/anime?q=${encodeURIComponent(searchTerms.slice(0, 3).join(" "))}&limit=25&order_by=score&sort=desc`)
        .then(r => r.ok ? r.json() : {data: []})
        .catch(() => ({data: []}))
    );
    
    searches.push(
      fetch(`https://api.jikan.moe/v4/anime?q=${encodeURIComponent(searchTerms.slice(3, 6).join(" "))}&limit=25&order_by=popularity&sort=asc`)
        .then(r => r.ok ? r.json() : {data: []})
        .catch(() => ({data: []}))
    );
    
    searches.push(
      fetch(`https://api.jikan.moe/v4/anime?q=${encodeURIComponent(searchTerms.slice(0, 4).join(" "))}&limit=25&order_by=start_date&sort=desc`)
        .then(r => r.ok ? r.json() : {data: []})
        .catch(() => ({data: []}))
    );
    
    searches.push(
      fetch(`https://api.jikan.moe/v4/anime?q=${encodeURIComponent(searchTerms.slice(2, 5).join(" "))}&limit=25&order_by=members&sort=desc`)
        .then(r => r.ok ? r.json() : {data: []})
        .catch(() => ({data: []}))
    );
    
    searches.push(
      fetch(`https://api.jikan.moe/v4/anime?q=${encodeURIComponent(searchTerms.slice(4, 7).join(" "))}&limit=25&order_by=favorites&sort=desc`)
        .then(r => r.ok ? r.json() : {data: []})
        .catch(() => ({data: []}))
    );

    const results = await Promise.all(searches);
    
    results.forEach(data => {
      if (data && data.data && Array.isArray(data.data)) {
        allResults.push(...data.data);
      }
    });

    // Eliminar duplicados
    const uniqueAnimes = [];
    const seenIds = new Set();
    
    allResults.forEach(anime => {
      if (anime && anime.mal_id && !seenIds.has(anime.mal_id)) {
        seenIds.add(anime.mal_id);
        uniqueAnimes.push(anime);
      }
    });

    // Calcular matchScore mejorado
    const scoredResults = uniqueAnimes.map(anime => {
      const animeText = `
        ${anime.title || ''} 
        ${anime.title_english || ''} 
        ${anime.title_japanese || ''}
        ${anime.synopsis || ''} 
        ${anime.genres?.map(g => g.name).join(' ') || ''}
        ${anime.themes?.map(t => t.name).join(' ') || ''}
        ${anime.demographics?.map(d => d.name).join(' ') || ''}
      `.toLowerCase();

      let matchScore = 0;
      let exactMatches = 0;
      
      expandedWords.forEach(word => {
        const escapedWord = word.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
        const regex = new RegExp(`\\b${escapedWord}\\b`, 'i');
        if (regex.test(animeText)) {
          matchScore += 2;
          if (queryWords.includes(word)) {
            exactMatches++;
          }
        }
      });

      matchScore += exactMatches * 5;

      if (anime.score >= 9) matchScore += 3;
      else if (anime.score >= 8) matchScore += 2;
      else if (anime.score >= 7) matchScore += 1;
      
      if (anime.popularity <= 100) matchScore += 3;
      else if (anime.popularity <= 500) matchScore += 2;
      else if (anime.popularity <= 1000) matchScore += 1;
      
      if (anime.members > 1000000) matchScore += 2;
      else if (anime.members > 500000) matchScore += 1;
      
      const currentYear = new Date().getFullYear();
      const animeYear = anime.year || (anime.aired?.from ? new Date(anime.aired.from).getFullYear() : 0);
      if (animeYear >= currentYear - 2) matchScore += 2;
      else if (animeYear >= currentYear - 5) matchScore += 1;

      return {
        title: anime.title_english || anime.title,
        titleJapanese: anime.title_japanese || anime.title,
        genres: anime.genres?.map(g => g.name) || [],
        themes: anime.themes?.map(t => t.name) || [],
        demographics: anime.demographics?.map(d => d.name) || [],
        description: anime.synopsis ? 
          (anime.synopsis.length > 240 ? anime.synopsis.substring(0, 240) + '...' : anime.synopsis) : 
          'No description available. Click to view more details on MyAnimeList.',
        rating: anime.score || 0,
        year: animeYear || 'N/A',
        episodes: anime.episodes || '?',
        image: anime.images?.jpg?.large_image_url || anime.images?.jpg?.image_url,
        url: anime.url,
        malId: anime.mal_id,
        type: anime.type || 'TV',
        status: anime.status || '',
        matchScore: matchScore
      };
    });

    return scoredResults
      .filter(anime => anime.matchScore > 0)
      .sort((a, b) => {
        if (b.matchScore !== a.matchScore) return b.matchScore - a.matchScore;
        return b.rating - a.rating;
      })
      .slice(0, 30);

  } catch (error) {
    console.error('Error:', error);
    return [];
  }
}

// ====================================
// MOSTRAR RESULTADOS
// ====================================
function displayResults(results) {
  animeGrid.innerHTML = "";
  
  if (results.length === 0) {
    matchInfo.innerHTML = `
      <span style="font-size: 3rem;">üòï</span><br>
      <strong>No animes found matching your search.</strong><br>
      <small style="opacity: 0.8;">Try different keywords or browse our complete collection:</small><br>
      <a href="https://ww3.animeonline.ninja/genero/anime-castellano/" target="_blank" rel="noopener" style="display: inline-block; margin-top: 1rem; padding: 0.8rem 2rem; background: var(--warning); color: white; text-decoration: none; border-radius: 10px; font-weight: 600;">üåê Browse All Animes</a>
    `;
    resultsSection.classList.add("show");
    return;
  }

  matchInfo.innerHTML = `
    <span style="font-size: 2.5rem;">‚ú®</span><br>
    Found <strong style="background: var(--accent); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; font-size: 1.3rem;">${results.length}</strong> perfect matches for you!
  `;

  results.forEach((anime, index) => {
    const card = document.createElement("div");
    card.classList.add("anime-card");
    card.style.animationDelay = `${index * 0.05}s`;
    card.setAttribute('role', 'listitem');
    
    const allTags = [...anime.genres, ...anime.themes, ...anime.demographics].slice(0, 7);
    const genresHTML = allTags.map(g => `<span class="genre-tag">${g}</span>`).join("");
    
    let scoreColor = '#667eea';
    if (anime.matchScore >= 20) scoreColor = '#11998e';
    else if (anime.matchScore >= 15) scoreColor = '#667eea';
    else if (anime.matchScore >= 10) scoreColor = '#4facfe';
    
    card.innerHTML = `
      ${anime.image ? `<img src="${anime.image}" alt="${anime.title}" class="anime-image" loading="lazy" onerror="this.src='https://via.placeholder.com/300x400/667eea/ffffff?text=${encodeURIComponent(anime.title)}'">` : `<div style="width: 100%; height: 400px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); display: flex; align-items: center; justify-content: center; color: white; font-weight: 700;">No Image</div>`}
      <div class="anime-content">
        <div class="match-score" style="background: ${scoreColor};">üéØ ${anime.matchScore}% Match</div>
        <h3 class="anime-title">${anime.title}</h3>
        ${anime.titleJapanese !== anime.title ? `<p style="font-size: 0.85rem; color: var(--text-secondary); margin-bottom: 0.5rem;">${anime.titleJapanese}</p>` : ''}
        <div class="anime-genres">${genresHTML}</div>
        <p class="anime-description">${anime.description}</p>
        <div class="anime-meta">
          <span>üìÖ ${anime.year}</span>
          <span>üì∫ ${anime.episodes} eps</span>
          <span>‚≠ê ${anime.rating ? anime.rating.toFixed(1) : 'N/A'}</span>
          <span>üìä ${anime.type}</span>
        </div>
        <div class="anime-links">
          <a href="${anime.url}" target="_blank" rel="noopener noreferrer" class="anime-link mal" aria-label="View ${anime.title} on MyAnimeList">üìã MAL Info</a>
          <a href="${getWatchLink(anime.title)}" target="_blank" rel="noopener noreferrer" class="anime-link watch" aria-label="Watch ${anime.title} free online">‚ñ∂Ô∏è Watch Free</a>
        </div>
      </div>
    `;
    animeGrid.appendChild(card);
  });

  resultsSection.classList.add("show");
  resultsSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
}

// ====================================
// SUBMIT FORM
// ====================================
searchForm.addEventListener("submit", async (e) => {
  e.preventDefault();
  searchBtn.classList.add("loading");
  resultsSection.classList.remove("show");

  try {
    const query = searchInput.value.trim();
    
    if (!query) {
      alert('Please enter a description of the anime you want to find!');
      searchBtn.classList.remove("loading");
      return;
    }
    
    saveToHistory(query);
    
    await new Promise(resolve => setTimeout(resolve, 500));
    
    const results = await searchAnimeAPI(query);
    displayResults(results);
    
  } catch (error) {
    console.error('Error:', error);
    matchInfo.innerHTML = `
      <span style="font-size: 3rem;">‚ö†Ô∏è</span><br>
      <strong>Error searching animes.</strong><br>
      <small>Please try again in a few seconds.</small>
    `;
    resultsSection.classList.add("show");
  } finally {
    searchBtn.classList.remove("loading");
  }
});

// ====================================
// CONSOLE LOG
// ====================================
console.log('%cüéå AnimeAI v3.0 - Enhanced Edition', 'color: #667eea; font-size: 20px; font-weight: bold;');
console.log('%c‚ú® Features:', 'color: #4facfe; font-size: 14px; font-weight: bold;');
console.log('  ‚Ä¢ 40,000+ anime database');
console.log('  ‚Ä¢ Multi-language search');
console.log('  ‚Ä¢ AI-powered matching');
console.log('  ‚Ä¢ 5 simultaneous API searches');
console.log('  ‚Ä¢ Smart synonym expansion');
console.log('  ‚Ä¢ Free streaming links');
console.log('%cüîç Powered by Jikan API (MyAnimeList)', 'color: #11998e; font-size: 12px;');
    </script>
</body>
</html>
